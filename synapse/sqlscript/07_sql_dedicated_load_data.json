{
	"name": "07_sql_dedicated_load_data",
	"properties": {
		"folder": {
			"name": "Module 03"
		},
		"content": {
			"query": "-- !! Make sure to run this against the DP500DWH database!\n\nCREATE SCHEMA [Staging]\nGO\n\nCREATE TABLE [Staging].[FactInternetSales]\n(\n\t[SalesOrderNumber] [nvarchar](20) NOT NULL,\n\t[SalesOrderLineNumber] [tinyint] NOT NULL,\n\t[CustomerKey] [int] NOT NULL,\n\t[ProductKey] [int] NOT NULL,\n\t[OrderDateKey] [int] NOT NULL,\n\t[DueDateKey] [int] NOT NULL,\n\t[ShipDateKey] [int] NULL,\n\t[PromotionKey] [int] NOT NULL,\n\t[CurrencyKey] [int] NOT NULL,\n\t[SalesTerritoryKey] [int] NOT NULL,\n\t[OrderQuantity] [smallint] NOT NULL,\n\t[UnitPrice] [money] NOT NULL,\n\t[ExtendedAmount] [money] NOT NULL,\n\t[UnitPriceDiscountPct] [decimal](7, 4) NOT NULL,\n\t[DiscountAmount] [float] NOT NULL,\n\t[ProductStandardCost] [money] NOT NULL,\n\t[TotalProductCost] [money] NOT NULL,\n\t[SalesAmount] [money] NOT NULL,\n\t[TaxAmount] [money] NOT NULL,\n\t[FreightAmount] [money] NOT NULL,\n\t[CarrierTrackingNumber] [nvarchar](25) NULL,\n\t[CustomerPONumber] [nvarchar](25) NULL,\n\t[RevisionNumber] [tinyint] NOT NULL\n\t)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nCOPY INTO [Staging].[FactInternetSales]\nFROM 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/data/FactInternetSales.txt'\nWITH\n(\n\tFILE_TYPE = 'CSV'\n\t,MAXERRORS = 0\n\t,FIELDTERMINATOR = '\\t'\n\t,FIRSTROW = 1\n\t,ERRORFILE = 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/errors/'\n    ,ENCODING = 'UTF16'\n)\nGO\n\n\n\n\nCREATE TABLE [Staging].[DimAccount]\n( \n\t[AccountKey] [int]  NOT NULL,\n\t[ParentAccountKey] [int]  NULL,\n\t[AccountCodeAlternateKey] [int]  NULL,\n\t[ParentAccountCodeAlternateKey] [int]  NULL,\n\t[AccountDescription] [nvarchar](50)  NULL,\n\t[AccountType] [nvarchar](50)  NULL,\n\t[Operator] [nvarchar](50)  NULL,\n\t[CustomMembers] [nvarchar](300)  NULL,\n\t[ValueType] [nvarchar](50)  NULL,\n\t[CustomMemberOptions] [nvarchar](200)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nCOPY INTO [Staging].[DimAccount]\nFROM 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/data/DimAccount.txt'\nWITH\n(\n\tFILE_TYPE = 'CSV'\n\t,MAXERRORS = 0\n\t,FIELDTERMINATOR = '\\t'\n\t,FIRSTROW = 1\n\t,ERRORFILE = 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/errors/'\n    ,ENCODING = 'UTF16'\n)\nGO\n\n--\nCREATE TABLE [Staging].[DimCurrency]\n( \n\t[CurrencyKey] [int]  NOT NULL,\n\t[CurrencyAlternateKey] [nchar](3)  NOT NULL,\n\t[CurrencyName] [nvarchar](50)  NOT NULL,\n\t[FormatString] [nvarchar](20)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nCOPY INTO [Staging].[DimCurrency]\nFROM 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/data/DimCurrency.txt'\nWITH\n(\n\tFILE_TYPE = 'CSV'\n\t,MAXERRORS = 0\n\t,FIELDTERMINATOR = '\\t'\n\t,FIRSTROW = 1\n\t,ERRORFILE = 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/errors/'\n    ,ENCODING = 'UTF16'\n)\nGO\n\n\n\nCREATE TABLE [Staging].[DimCustomer]\n( \n\t[CustomerKey] [int]  NOT NULL,\n\t[GeographyKey] [int]  NULL,\n\t[CustomerAlternateKey] [nvarchar](15)  NOT NULL,\n\t[Title] [nvarchar](8)  NULL,\n\t[FirstName] [nvarchar](50)  NULL,\n\t[MiddleName] [nvarchar](50)  NULL,\n\t[LastName] [nvarchar](50)  NULL,\n\t[NameStyle] [bit]  NULL,\n\t[BirthDate] [date]  NULL,\n\t[MaritalStatus] [nchar](1)  NULL,\n\t[Suffix] [nvarchar](10)  NULL,\n\t[Gender] [nvarchar](1)  NULL,\n\t[EmailAddress] [nvarchar](50)  NULL,\n\t[YearlyIncome] [money]  NULL,\n\t[TotalChildren] [tinyint]  NULL,\n\t[NumberChildrenAtHome] [tinyint]  NULL,\n\t[EnglishEducation] [nvarchar](40)  NULL,\n\t[SpanishEducation] [nvarchar](40)  NULL,\n\t[FrenchEducation] [nvarchar](40)  NULL,\n\t[EnglishOccupation] [nvarchar](100)  NULL,\n\t[SpanishOccupation] [nvarchar](100)  NULL,\n\t[FrenchOccupation] [nvarchar](100)  NULL,\n\t[HouseOwnerFlag] [nchar](1)  NULL,\n\t[NumberCarsOwned] [tinyint]  NULL,\n\t[AddressLine1] [nvarchar](120)  NULL,\n\t[AddressLine2] [nvarchar](120)  NULL,\n\t[Phone] [nvarchar](20)  NULL,\n\t[DateFirstPurchase] [date]  NULL,\n\t[CommuteDistance] [nvarchar](15)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\nGO\n\nCOPY INTO [Staging].[DimCustomer]\nFROM 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/data/DimCustomer.txt'\nWITH\n(\n\tFILE_TYPE = 'CSV'\n\t,MAXERRORS = 0\n\t,FIELDTERMINATOR = '\\t'\n\t,FIRSTROW = 1\n\t,ERRORFILE = 'https://datalake6oq3z6xmzhbbc.dfs.core.windows.net/landing/Allfiles/03/errors/'\n    ,ENCODING = 'UTF16'\n)\nGO\n\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "DP500DWH",
				"poolName": "DP500DWH"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}